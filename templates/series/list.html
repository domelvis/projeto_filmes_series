{% extends 'base.html' %}

{% block title %}Cat√°logo de S√©ries - Plataforma S√©ries TV{% endblock %}

{% block meta %}
<meta name="description" content="Explore nosso cat√°logo completo de s√©ries. Filtre por g√™nero, ano, avalia√ß√£o e encontre suas pr√≥ximas s√©ries favoritas.">
<meta name="keywords" content="s√©ries, cat√°logo, TV, streaming, epis√≥dios">
{% endblock %}

{% block content %}
<!-- Header Principal com Breadcrumb -->
<header class="page-header mb-8" aria-labelledby="page-title">
    <nav class="breadcrumb-nav" aria-label="Navega√ß√£o estrutural">
        <ol class="breadcrumb flex items-center space-x-2 text-sm text-gray-600">
            <li class="breadcrumb-item">
                <a href="{% url 'series:home' %}" class="breadcrumb-link flex items-center hover:text-blue-600 transition-colors">
                    <span class="breadcrumb-icon mr-1">üè†</span>
                    In√≠cio
                </a>
            </li>
            <li class="breadcrumb-item active flex items-center" aria-current="page">
                <span class="mx-2">‚ûû</span>
                <span class="breadcrumb-icon mr-1">üì∫</span>
                <span class="text-gray-900 font-medium">Cat√°logo de S√©ries</span>
            </li>
        </ol>
    </nav>

    <div class="header-content">
        <div class="header-text">
            <h1 id="page-title" class="page-title">
                <span class="title-icon">üé¨</span>
                Cat√°logo de S√©ries
            </h1>
            <p class="page-subtitle">Descubra e explore nossa cole√ß√£o completa de s√©ries</p>
            <div class="stats-bar">
                <span class="stat-item">
                    <strong>{{ total_series }}</strong> s√©ries dispon√≠veis
                </span>
                <span class="stat-item">
                    <strong>{{ total_generos }}</strong> g√™neros
                </span>
                <span class="stat-item">
                    <strong>{{ recent_added }}</strong> adicionadas este m√™s
                </span>
            </div>
        </div>

        {% if user.is_authenticated %}
        <div class="header-actions">
            <a href="{% url 'series:create' %}" class="btn-primary" aria-label="Adicionar nova s√©rie">
                <span class="btn-icon">‚ûï</span>
                Adicionar S√©rie
            </a>
        </div>
        {% endif %}
    </div>
</header>

<!-- Sistema de Filtros e Busca -->
<section class="filters-section" aria-labelledby="filters-title">
    <div class="filters-header">
        <h2 id="filters-title" class="filters-title">Filtrar e Buscar</h2>
        <button class="filters-toggle" aria-expanded="false" aria-controls="filters-content">
            <span class="toggle-icon">‚öôÔ∏è</span>
            Mostrar Filtros
        </button>
    </div>

    <div id="filters-content" class="filters-content" hidden>
        <form method="GET" action="{% url 'series:list' %}" class="filters-form" id="filters-form">
            <!-- Busca R√°pida -->
            <div class="filter-group">
                <label for="search-input" class="filter-label">
                    <span class="label-icon">üîç</span>
                    Buscar por t√≠tulo
                </label>
                <input type="text" 
                       id="search-input" 
                       name="search" 
                       value="{{ search }}"
                       class="search-input" 
                       placeholder="Digite o nome da s√©rie..."
                       aria-describedby="search-help">
                <small id="search-help" class="help-text">Busque por t√≠tulo, descri√ß√£o ou palavras-chave</small>
            </div>

            <!-- Filtros em Grid -->
            <div class="filters-grid">
                <!-- G√™nero -->
                <div class="filter-group">
                    <label for="genero-filter" class="filter-label">G√™nero</label>
                    <select id="genero-filter" name="genero" class="filter-select">
                        <option value="">Todos os g√™neros</option>
                        {% for value, label in generos %}
                        <option value="{{ value }}" {% if genero_selecionado == value %}selected{% endif %}>
                            {{ label }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Ano -->
                <div class="filter-group">
                    <label for="ano-filter" class="filter-label">Ano de Lan√ßamento</label>
                    <select id="ano-filter" name="ano" class="filter-select">
                        <option value="">Todos os anos</option>
                        {% for year in anos_disponiveis %}
                        <option value="{{ year }}" {% if ano_selecionado == year %}selected{% endif %}>
                            {{ year }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Ordena√ß√£o -->
                <div class="filter-group">
                    <label for="ordenacao-filter" class="filter-label">Ordenar por</label>
                    <select id="ordenacao-filter" name="ordenacao" class="filter-select">
                        <option value="recentes" {% if ordenacao == 'recentes' %}selected{% endif %}>Mais Recentes</option>
                        <option value="antigos" {% if ordenacao == 'antigos' %}selected{% endif %}>Mais Antigos</option>
                        <option value="titulo_az" {% if ordenacao == 'titulo_az' %}selected{% endif %}>T√≠tulo A-Z</option>
                        <option value="titulo_za" {% if ordenacao == 'titulo_za' %}selected{% endif %}>T√≠tulo Z-A</option>
                        <option value="avaliacao" {% if ordenacao == 'avaliacao' %}selected{% endif %}>Melhor Avaliados</option>
                    </select>
                </div>

                <!-- Status -->
                <div class="filter-group">
                    <label for="status-filter" class="filter-label">Status</label>
                    <select id="status-filter" name="status" class="filter-select">
                        <option value="">Todos os status</option>
                        <option value="em_andamento" {% if status_selecionado == 'em_andamento' %}selected{% endif %}>Em Andamento</option>
                        <option value="concluida" {% if status_selecionado == 'concluida' %}selected{% endif %}>Conclu√≠da</option>
                        <option value="cancelada" {% if status_selecionado == 'cancelada' %}selected{% endif %}>Cancelada</option>
                    </select>
                </div>
            </div>

            <!-- A√ß√µes dos Filtros -->
            <div class="filter-actions">
                <button type="submit" class="btn-filter-primary">
                    <span class="btn-icon">üîç</span>
                    Aplicar Filtros
                </button>
                <a href="{% url 'series:list' %}" class="btn-filter-secondary" aria-label="Limpar todos os filtros">
                    <span class="btn-icon">üîÑ</span>
                    Limpar Filtros
                </a>
                <button type="button" class="btn-filter-save" id="save-filters">
                    <span class="btn-icon">üíæ</span>
                    Salvar Prefer√™ncias
                </button>
            </div>
        </form>
    </div>
</section>

<!-- Resultados e Informa√ß√µes -->
<section class="results-section" aria-labelledby="results-title">
    <div class="results-header">
        <h2 id="results-title" class="results-title">S√©ries Encontradas</h2>
        
        {% if search or genero_selecionado or ano_selecionado %}
        <div class="active-filters">
            <span class="filters-label">Filtros ativos:</span>
            <div class="filters-tags">
                {% if search %}
                <span class="filter-tag">
                    Busca: "{{ search }}"
                    <button class="tag-remove" data-filter="search" aria-label="Remover filtro de busca">√ó</button>
                </span>
                {% endif %}
                {% if genero_selecionado %}
                <span class="filter-tag">
                    G√™nero: {{ genero_selecionado }}
                    <button class="tag-remove" data-filter="genero" aria-label="Remover filtro de g√™nero">√ó</button>
                </span>
                {% endif %}
                {% if ano_selecionado %}
                <span class="filter-tag">
                    Ano: {{ ano_selecionado }}
                    <button class="tag-remove" data-filter="ano" aria-label="Remover filtro de ano">√ó</button>
                </span>
                {% endif %}
            </div>
        </div>
        {% endif %}

        <div class="results-info">
            <span class="results-count">
                <strong>{{ series|length }}</strong> s√©rie{{ series|length|pluralize }} encontrada{{ series|length|pluralize }}
            </span>
            <div class="view-options">
                <button class="view-option active" data-view="grid" aria-label="Visualiza√ß√£o em grade">
                    <span>‚èπÔ∏è</span>
                </button>
                <button class="view-option" data-view="list" aria-label="Visualiza√ß√£o em lista">
                    <span>üìã</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Grid de S√©ries -->
    {% if series %}
    <div class="series-grid" id="series-container" data-view="grid">
        {% for serie in series %}
        <article class="series-card" data-series-id="{{ serie.id }}" itemscope itemtype="https://schema.org/TVSeries">
            <!-- Header do Card -->
            <div class="card-header">
                {% if serie.imagem %}
                <img src="{{ serie.imagem.url }}" 
                     alt="{{ serie.titulo }}"
                     class="card-image"
                     loading="lazy"
                     itemprop="image">
                {% else %}
                <div class="card-image-placeholder" aria-hidden="true">
                    <span class="placeholder-icon">üì∫</span>
                </div>
                {% endif %}

                <div class="card-badges">
                    <span class="genre-badge" data-genero="{{ serie.genero }}">
                        {{ serie.get_genero_display }}
                    </span>
                    {% if serie.esta_em_alta %}
                    <span class="trending-badge" aria-label="S√©rie em alta">üî•</span>
                    {% endif %}
                </div>
            </div>

            <!-- Conte√∫do do Card -->
            <div class="card-content">
                <h3 class="card-title" itemprop="name">
                    <a href="{{ serie.get_absolute_url }}" class="card-link">
                        {{ serie.titulo }}
                    </a>
                </h3>

                <div class="card-meta">
                    <span class="meta-item" itemprop="dateCreated">
                        <span class="meta-icon">üìÖ</span>
                        {{ serie.ano }}
                    </span>
                    <span class="meta-item">
                        <span class="meta-icon">‚≠ê</span>
                        <span itemprop="aggregateRating">{{ serie.avaliacao_media|default:"N/A" }}</span>
                    </span>
                    <span class="meta-item">
                        <span class="meta-icon">üë§</span>
                        {{ serie.criado_por.username }}
                    </span>
                </div>

                <p class="card-description" itemprop="description">
                    {{ serie.descricao|truncatewords:25 }}
                </p>

                <div class="card-stats">
                    <span class="stat">
                        <strong>{{ serie.total_episodios }}</strong> epis√≥dios
                    </span>
                    <span class="stat">
                        <strong>{{ serie.total_temporadas }}</strong> temporadas
                    </span>
                </div>
            </div>

            <!-- Footer do Card -->
            <footer class="card-footer">
                <div class="card-actions">
                    <a href="{{ serie.get_absolute_url }}" class="btn-card-primary" aria-label="Ver detalhes de {{ serie.titulo }}">
                        <span class="btn-icon">üëÅÔ∏è</span>
                        Ver Detalhes
                    </a>
                    
                    {% if user.is_authenticated %}
                    <div class="card-interactions">
                        <button class="btn-favorite" data-series-id="{{ serie.id }}" aria-label="Adicionar aos favoritos">
                            <span class="favorite-icon">ü§ç</span>
                        </button>
                        <button class="btn-watchlist" data-series-id="{{ serie.id }}" aria-label="Adicionar √† watchlist">
                            <span class="watchlist-icon">üìã</span>
                        </button>
                    </div>
                    {% endif %}
                </div>

                {% if user.is_authenticated and user == serie.criado_por %}
                <div class="card-admin-actions">
                    <a href="{% url 'series:update' serie.pk %}" class="btn-edit" aria-label="Editar s√©rie {{ serie.titulo }}">
                        <span class="btn-icon">‚úèÔ∏è</span>
                        Editar
                    </a>
                    <a href="{% url 'series:delete' serie.pk %}" class="btn-delete" aria-label="Deletar s√©rie {{ serie.titulo }}">
                        <span class="btn-icon">üóëÔ∏è</span>
                        Deletar
                    </a>
                </div>
                {% endif %}
            </footer>
        </article>
        {% endfor %}
    </div>

    <!-- Pagina√ß√£o -->
    {% if is_paginated %}
    <nav class="pagination-nav" aria-label="Navega√ß√£o entre p√°ginas de resultados">
        <ul class="pagination">
            {% if page_obj.has_previous %}
            <li class="pagination-item">
                <a href="?page=1{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" 
                   class="pagination-link pagination-first" aria-label="Primeira p√°gina">
                    <span aria-hidden="true">¬´¬´</span>
                </a>
            </li>
            <li class="pagination-item">
                <a href="?page={{ page_obj.previous_page_number }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" 
                   class="pagination-link pagination-prev" aria-label="P√°gina anterior">
                    <span aria-hidden="true">‚Äπ</span>
                </a>
            </li>
            {% endif %}

            {% for num in page_obj.paginator.page_range %}
                {% if page_obj.number == num %}
                <li class="pagination-item active">
                    <span class="pagination-link current" aria-current="page">
                        {{ num }}
                    </span>
                </li>
                {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                <li class="pagination-item">
                    <a href="?page={{ num }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" 
                       class="pagination-link">
                        {{ num }}
                    </a>
                </li>
                {% endif %}
            {% endfor %}

            {% if page_obj.has_next %}
            <li class="pagination-item">
                <a href="?page={{ page_obj.next_page_number }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" 
                   class="pagination-link pagination-next" aria-label="Pr√≥xima p√°gina">
                    <span aria-hidden="true">‚Ä∫</span>
                </a>
            </li>
            <li class="pagination-item">
                <a href="?page={{ page_obj.paginator.num_pages }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" 
                   class="pagination-link pagination-last" aria-label="√öltima p√°gina">
                    <span aria-hidden="true">¬ª¬ª</span>
                </a>
            </li>
            {% endif %}
        </ul>

        <div class="pagination-info">
            P√°gina {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
            <span class="pagination-total">(Total: {{ paginator.count }} itens)</span>
        </div>
    </nav>
    {% endif %}

    {% else %}
    <!-- Estado Vazio -->
    <div class="empty-state" aria-live="polite">
        <div class="empty-icon">üîç</div>
        <h3 class="empty-title">Nenhuma s√©rie encontrada</h3>
        <p class="empty-description">
            {% if search or genero_selecionado or ano_selecionado %}
            N√£o encontramos resultados para os filtros aplicados. Tente:
            <ul class="empty-suggestions">
                <li>Verificar a ortografia dos termos buscados</li>
                <li>Utilizar filtros menos espec√≠ficos</li>
                <li>Explorar todas as s√©ries dispon√≠veis</li>
            </ul>
            {% else %}
            O cat√°logo est√° vazio no momento. 
            {% if user.is_authenticated %}
            <a href="{% url 'series:create' %}" class="empty-action">Seja o primeiro a adicionar uma s√©rie!</a>
            {% endif %}
            {% endif %}
        </p>
        {% if search or genero_selecionado or ano_selecionado %}
        <a href="{% url 'series:list' %}" class="btn-empty-primary">
            <span class="btn-icon">üì∫</span>
            Ver Todas as S√©ries
        </a>
        {% endif %}
    </div>
    {% endif %}
</section>

<!-- Sugest√µes e Conte√∫do Relacionado -->
{% if series and not search and not genero_selecionado %}
<section class="recommendations-section" aria-labelledby="recommendations-title">
    <h2 id="recommendations-title" class="recommendations-title">Voc√™ Pode Gostar</h2>
    <div class="recommendations-grid">
        <!-- As 3 s√©ries mais bem avaliadas -->
        {% for serie in series_mais_populares|slice:":3" %}
        <div class="recommendation-card">
            <a href="{{ serie.get_absolute_url }}" class="recommendation-link">
                {% if serie.imagem %}
                <img src="{{ serie.imagem.url }}" alt="{{ serie.titulo }}" class="recommendation-image">
                {% endif %}
                <span class="recommendation-title">{{ serie.titulo }}</span>
                <span class="recommendation-rating">‚≠ê {{ serie.avaliacao_media }}</span>
            </a>
        </div>
        {% endfor %}
    </div>
</section>
{% endif %}
{% endblock %}

{% block extra_scripts %}
<!-- Scripts espec√≠ficos para esta p√°gina ser√£o carregados aqui -->
<script>
 // Vari√°veis globais para configura√ß√£o
const PAGE_CONFIG = {
    // A p√°gina atual √© um n√∫mero (integer).
    currentPage: 1, // Exemplo: 1. Substitua por um valor padr√£o.
    
    // O total de p√°ginas √© um n√∫mero (integer).
    totalPages: 1, // Exemplo: 1. Substitua por um valor padr√£o.
    
    // O termo de busca √© uma string.
    searchTerm: "", // Exemplo: "".
    
    // Os endpoints da API s√£o strings de URL.
    apiEndpoints: {
        search: "/api/series/search/",     // Exemplo de URL.
        favorite: "/api/series/favorite/", // Exemplo de URL.
        watchlist: "/api/series/watchlist/"// Exemplo de URL.
    }
};

// Se voc√™ precisar que os valores sejam din√¢micos, eles devem ser passados para 
// o JS ap√≥s a renderiza√ß√£o do template, por exemplo, por meio de data-attributes 
// em um elemento HTML ou usando a sintaxe original dentro do seu template.
</script>

<!-- Inicializa√ß√£o dos Componentes JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Configura√ß√£o din√¢mica baseada nos dados do template
    const seriesGrid = document.getElementById('series-container');
    const filtersForm = document.getElementById('filters-form');
    
    if (seriesGrid) {
        // Passar dados din√¢micos para o JavaScript
        seriesGrid.dataset.totalSeries = '{{ total_series }}';
        seriesGrid.dataset.currentPage = '{{ page_obj.number|default:1 }}';
        seriesGrid.dataset.totalPages = '{{ page_obj.paginator.num_pages|default:1 }}';
        seriesGrid.dataset.searchTerm = '{{ search|default:""|escapejs }}';
    }

    // Inicializar sistema de visualiza√ß√£o (grid/list)
    initViewSystem();
    
    // Inicializar filtros avan√ßados
    initAdvancedFilters();
    
    // Inicializar sistema de favoritos
    initFavoriteSystem();
    
    // Inicializar tooltips e intera√ß√µes
    initUIInteractions();
});

// Sistema de Visualiza√ß√£o (Grid/List)
function initViewSystem() {
    const viewOptions = document.querySelectorAll('.view-option');
    const seriesContainer = document.getElementById('series-container');
    
    viewOptions.forEach(option => {
        option.addEventListener('click', function() {
            const viewType = this.dataset.view;
            
            // Atualizar estado visual
            viewOptions.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');
            
            // Aplicar visualiza√ß√£o
            seriesContainer.dataset.view = viewType;
            seriesContainer.className = `series-view series-view--${viewType}`;
            
            // Salvar prefer√™ncia
            localStorage.setItem('seriesViewPreference', viewType);
        });
    });
    
    // Restaurar prefer√™ncia salva
    const savedView = localStorage.getItem('seriesViewPreference') || 'grid';
    const savedOption = document.querySelector(`[data-view="${savedView}"]`);
    if (savedOption) savedOption.click();
}

// Sistema de Filtros Avan√ßados
function initAdvancedFilters() {
    const filtersToggle = document.querySelector('.filters-toggle');
    const filtersContent = document.getElementById('filters-content');
    
    if (filtersToggle && filtersContent) {
        filtersToggle.addEventListener('click', function() {
            const isExpanded = this.getAttribute('aria-expanded') === 'true';
            this.setAttribute('aria-expanded', !isExpanded);
            filtersContent.hidden = isExpanded;
            
            this.querySelector('.toggle-icon').textContent = isExpanded ? '‚öôÔ∏è' : '‚ûñ';
            this.innerHTML = this.innerHTML.replace(
                isExpanded ? 'Mostrar Filtros' : 'Ocultar Filtros',
                isExpanded ? 'Ocultar Filtros' : 'Mostrar Filtros'
            );
        });
    }

    // Remo√ß√£o de filtros ativos
    const removeButtons = document.querySelectorAll('.tag-remove');
    removeButtons.forEach(button => {
        button.addEventListener('click', function() {
            const filterType = this.dataset.filter;
            removeFilter(filterType);
        });
    });

    // Busca em tempo real (debounce)
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        let searchTimeout;
        searchInput.addEventListener('input', function() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                if (this.value.length >= 3 || this.value.length === 0) {
                    performSearch(this.value);
                }
            }, 500);
        });
    }
}

// Sistema de Favoritos
function initFavoriteSystem() {
    const favoriteButtons = document.querySelectorAll('.btn-favorite');
    
    favoriteButtons.forEach(button => {
        button.addEventListener('click', function() {
            const seriesId = this.dataset.seriesId;
            toggleFavorite(seriesId, this);
        });
    });
}

// Intera√ß√µes de UI
function initUIInteractions() {
    // Tooltips para elementos interativos
    const elementsWithTooltip = document.querySelectorAll('[data-tooltip]');
    elementsWithTooltip.forEach(element => {
        element.addEventListener('mouseenter', showTooltip);
        element.addEventListener('mouseleave', hideTooltip);
    });

    // Loading states para a√ß√µes
    const actionButtons = document.querySelectorAll('.btn-card-primary, .btn-favorite, .btn-watchlist');
    actionButtons.forEach(button => {
        button.addEventListener('click', function() {
            this.classList.add('loading');
        });
    });

    // Intersection Observer para lazy loading de imagens
    if ('IntersectionObserver' in window) {
        const lazyImages = document.querySelectorAll('.card-image[loading="lazy"]');
        const imageObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    img.src = img.dataset.src;
                    img.classList.remove('lazy');
                    imageObserver.unobserve(img);
                }
            });
        });

        lazyImages.forEach(img => imageObserver.observe(img));
    }
}

// Fun√ß√µes Auxiliares
function removeFilter(filterType) {
    const url = new URL(window.location);
    url.searchParams.delete(filterType);
    window.location.href = url.toString();
}

function performSearch(query) {
    const url = new URL(window.location);
    if (query) {
        url.searchParams.set('search', query);
    } else {
        url.searchParams.delete('search');
    }
    window.location.href = url.toString();
}

function toggleFavorite(seriesId, button) {
    // Simular API call - implementar com sua API real
    button.classList.add('loading');
    
    fetch(PAGE_CONFIG.apiEndpoints.favorite, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCSRFToken()
        },
        body: JSON.stringify({ series_id: seriesId })
    })
    .then(response => response.json())
    .then(data => {
        button.classList.remove('loading');
        if (data.success) {
            button.querySelector('.favorite-icon').textContent = data.is_favorite ? '‚ù§Ô∏è' : 'ü§ç';
            showToast(data.message || 'Favorito atualizado!');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        button.classList.remove('loading');
        showToast('Erro ao atualizar favorito', 'error');
    });
}

function getCSRFToken() {
    return document.querySelector('[name=csrfmiddlewaretoken]')?.value;
}

function showToast(message, type = 'success') {
    // Implementar sistema de toast notifications
    console.log(`${type}: ${message}`);
}

function showTooltip(event) {
    // Implementar sistema de tooltips
}

function hideTooltip(event) {
    // Implementar sistema de tooltips
}

// Exportar fun√ß√µes para uso global (se necess√°rio)
window.SeriesList = {
    initViewSystem,
    initAdvancedFilters,
    toggleFavorite,
    performSearch
};
</script>

<!-- Schema.org para SEO da p√°gina de listagem -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "ItemList",
  "name": "Cat√°logo de S√©ries",
  "description": "Lista completa de s√©ries de TV dispon√≠veis na plataforma",
  "numberOfItems": "{{ total_series }}",
  "itemListOrder": "{% if ordenacao == 'recentes' %}Descending{% else %}Ascending{% endif %}",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{% url 'series:list' %}"
  }
}
</script>

<!-- Componente de Loading para opera√ß√µes ass√≠ncronas -->
<template id="loading-template">
    <div class="loading-overlay">
        <div class="loading-spinner"></div>
        <p class="loading-text">Carregando...</p>
    </div>
</template>

<!-- Template para cards de s√©rie (para poss√≠vel renderiza√ß√£o client-side) -->
<template id="series-card-template">
    <article class="series-card" itemscope itemtype="https://schema.org/TVSeries">
        <div class="card-header">
            <img class="card-image" loading="lazy" alt="" itemprop="image">
            <div class="card-badges">
                <span class="genre-badge" itemprop="genre"></span>
            </div>
        </div>
        <div class="card-content">
            <h3 class="card-title" itemprop="name">
                <a class="card-link" itemprop="url"></a>
            </h3>
            <div class="card-meta">
                <span class="meta-item" itemprop="dateCreated"></span>
                <span class="meta-item" itemprop="aggregateRating"></span>
                <span class="meta-item" itemprop="author"></span>
            </div>
            <p class="card-description" itemprop="description"></p>
            <div class="card-stats">
                <span class="stat" itemprop="numberOfEpisodes"></span>
                <span class="stat" itemprop="numberOfSeasons"></span>
            </div>
        </div>
        <footer class="card-footer">
            <!-- Actions -->
        </footer>
    </article>
</template>
{% endblock %}

<!-- Footer Espec√≠fico da P√°gina de Listagem -->
<footer class="page-footer page-footer--catalog" role="contentinfo">
    <div class="footer-content">
        <div class="footer-section">
            <h4 class="footer-title">Estat√≠sticas do Cat√°logo</h4>
            <div class="catalog-stats">
                <div class="stat-item">
                    <span class="stat-number">{{ total_series }}</span>
                    <span class="stat-label">S√©ries Cadastradas</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">{{ total_generos }}</span>
                    <span class="stat-label">G√™neros Dispon√≠veis</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">{{ recent_added }}</span>
                    <span class="stat-label">Novas Este M√™s</span>
                </div>
            </div>
        </div>
        
        <div class="footer-section">
            <h4 class="footer-title">Navega√ß√£o R√°pida</h4>
            <ul class="footer-links">
                <li><a href="{% url 'series:home' %}" class="footer-link">üè† P√°gina Inicial</a></li>
                <li><a href="{% url 'series:create' %}" class="footer-link">‚ûï Adicionar S√©rie</a></li>
                <li><a href="/generos" class="footer-link">üìã Ver por G√™nero</a></li>
                <li><a href="/populares" class="footer-link">üî• Mais Populares</a></li>
            </ul>
        </div>

        <div class="footer-section">
            <h4 class="footer-title">Ajuda</h4>
            <ul class="footer-links">
                <li><a href="/ajuda/pesquisa" class="footer-link">üîç Como Pesquisar</a></li>
                <li><a href="/ajuda/filtros" class="footer-link">‚öôÔ∏è Usar Filtros</a></li>
                <li><a href="/contato" class="footer-link">üìß Reportar Problema</a></li>
            </ul>
        </div>
    </div>

    <div class="footer-bottom">
        <p class="footer-copyright">
            &copy; {% now "Y" %} Cat√°logo de S√©ries TV. 
            <span class="footer-version">v{{ APP_VERSION }}</span>
        </p>
        <p class="footer-notice">
            √öltima atualiza√ß√£o: {% now "d/m/Y H:i" %}
            {% if user.is_staff %}
            | <a href="/admin/series/serie/" class="admin-link">Painel Admin</a>
            {% endif %}
        </p>
    </div>
</footer>

<!-- Modal de Confirma√ß√£o para A√ß√µes -->
<dialog id="actionModal" class="modal">
    <div class="modal-content">
        <h3 class="modal-title" id="modalTitle">Confirmar A√ß√£o</h3>
        <div class="modal-body">
            <p id="modalMessage">Tem certeza que deseja realizar esta a√ß√£o?</p>
        </div>
        <div class="modal-actions">
            <button class="btn btn--secondary" onclick="this.closest('dialog').close()">Cancelar</button>
            <button class="btn btn--primary" id="modalConfirm">Confirmar</button>
        </div>
    </div>
</dialog>

<!-- Sistema de Notifica√ß√µes Toast -->
<div id="toastContainer" class="toast-container" aria-live="polite" aria-atomic="true"></div>

<!-- Fallback para JavaScript Desabilitado -->
<noscript>
    <div class="noscript-warning">
        <div class="warning-content">
            <h3>‚ö†Ô∏è JavaScript Recomendado</h3>
            <p>Para uma experi√™ncia completa com busca em tempo real e filtros avan√ßados, habilite o JavaScript.</p>
            <p>Voc√™ ainda pode usar a funcionalidade b√°sica de busca e filtros.</p>
        </div>
    </div>
</noscript>

</main>

<!-- Script de An√°lise de Uso -->
<script>
// Analytics de intera√ß√£o com a p√°gina
if (typeof gtag !== 'undefined') {
    gtag('event', 'page_view', {
        'page_title': 'Cat√°logo de S√©ries',
        'page_location': window.location.href,
        'total_series': {{ total_series }},
        'current_filters': {
            'search': '{{ search|default:"" }}',
            'genero': '{{ genero_selecionado|default:"" }}',
            'ano': '{{ ano_selecionado|default:"" }}'
        }
    });
}

// Monitoramento de performance
window.addEventListener('load', function() {
    if ('performance' in window) {
        const perfData = performance.timing;
        const loadTime = perfData.loadEventEnd - perfData.navigationStart;
        
        if (typeof gtag !== 'undefined') {
            gtag('event', 'timing_complete', {
                'name': 'page_load',
                'value': loadTime,
                'event_category': 'Load Time'
            });
        }
    }
});
</script>

</body>
</html>